<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-LRC583636J"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-LRC583636J");
    </script>

    <meta charset="utf-8" />

    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>BeatleTech | Coen Stevens | Jekyll and Algolia search integration</title>

    <meta name="description" content="BeatleTech by Coen Stevens" />

    
    <meta name="keywords" content="post, development, javascript, Jekyll, Algolia" />
    

    <meta name="author" content="Coen Stevens" />

    <link href="../../../../style.css" rel="stylesheet" type="text/css" />

    <link
      rel="shortcut icon"
      href="../../../../favicon.ico"
      type="image/x-icon"
    />

    <meta
      property="og:title"
      content="Jekyll and Algolia search integration"
    />

    <meta
      property="og:description"
      content=""
    />

    <meta
      property="og:url"
      content="https://beatletech.com/2020/08/16/jekyll-and-algolia-search-integration"
    />

    
    <meta
      property="og:image"
      content="https://beatletech.com/images/jekyll-and-algolia.png"
    />
    

    <!--[if lt IE 9]>
      <script
        src="https://html5shiv.googlecode.com/svn/trunk/html5.js"
        type="text/javascript"
      ></script>
    <![endif]-->

    <!--[if lte IE 7]>
      <link href="../../../../css/ie.css" rel="stylesheet" type="text/css" />
    <![endif]-->
  </head>

  <body class="post-page">
    <div id="wrapper" class="container_12">
      <header id="header" class="grid_12">
        <h1>
          <a href="/" style="margin-top: 20px; color: rgb(47, 50, 57)"
            >BeatleTech</a
          >
        </h1>
        <img
          id="headshot"
          src="https://s3-eu-west-1.amazonaws.com/eu-west-1.beatletech.com/images/headshot.png"
          alt="It's only Hubris if you lose."
          title="It's only Hubris if you lose."
          height="155"
          width="200"
          class="thumbnail alignright"
          onmouseover="onHover();"
          onmouseout="offHover();"
        />
        <div id="freelancer">Coen JC Stevens</div>
      </header>
      <!-- end header -->

      <div id="content">
        <nav>
          <ul id="menu" class="clearfix no-margin">
            <li><a href="/">Services</a></li>
            <!-- <li><a href="../../../../cases">Cases</a></li> -->
            <li><a href="../../../../setup">Setup</a></li>
            <li class="current"><a href="../../../../blog">Blog</a></li>
            <li><a href="../../../../archive">Archive</a></li>
            <li>
              <div
                id="search-searchbar"
                style="margin-top: -4px; margin-bottom: -10px; width: 265px"
              ></div>
            </li>
          </ul>
          <br class="clear" />
        </nav>

        <div id="main" class="grid_9 alpha">
          <div id="search-hits-wrapper" style="display: none">
            <h3>Search results</h3>
            <a
              href="https://www.algolia.com/?utm_source=instantsearch.js&amp;utm_medium=website&amp;utm_content=instantsearchjs.netlify.app&amp;utm_campaign=poweredby"
              target="_blank"
              class="ais-PoweredBy-link"
              style="float: right; margin-right: 0px"
              aria-label="Search by Algolia"
              rel="noopener noreferrer"
              ><svg
                height="1.2em"
                class="ais-PoweredBy-logo"
                viewBox="0 0 168 24"
                style="width: auto"
              >
                <path
                  fill="#5D6494"
                  d="M6.97 6.68V8.3a4.47 4.47 0 0 0-2.42-.67 2.2 2.2 0 0 0-1.38.4c-.34.26-.5.6-.5 1.02 0 .43.16.77.49 1.03.33.25.83.53 1.51.83a7.04 7.04 0 0 1 1.9 1.08c.34.24.58.54.73.89.15.34.23.74.23 1.18 0 .95-.33 1.7-1 2.24a4 4 0 0 1-2.6.81 5.71 5.71 0 0 1-2.94-.68v-1.71c.84.63 1.81.94 2.92.94.58 0 1.05-.14 1.39-.4.34-.28.5-.65.5-1.13 0-.29-.1-.55-.3-.8a2.2 2.2 0 0 0-.65-.53 23.03 23.03 0 0 0-1.64-.78 13.67 13.67 0 0 1-1.11-.64c-.12-.1-.28-.22-.46-.4a1.72 1.72 0 0 1-.39-.5 4.46 4.46 0 0 1-.22-.6c-.07-.23-.1-.48-.1-.75 0-.91.33-1.63 1-2.17a4 4 0 0 1 2.57-.8c.97 0 1.8.18 2.47.52zm7.47 5.7v-.3a2.26 2.26 0 0 0-.5-1.44c-.3-.35-.74-.53-1.32-.53-.53 0-.99.2-1.37.58-.38.39-.62.95-.72 1.68h3.91zm1 2.79v1.4c-.6.34-1.38.51-2.36.51a4.02 4.02 0 0 1-3-1.13 4.04 4.04 0 0 1-1.11-2.97c0-1.3.34-2.32 1.02-3.06a3.38 3.38 0 0 1 2.6-1.1c1.03 0 1.85.32 2.46.96.6.64.9 1.57.9 2.78 0 .33-.03.68-.09 1.04h-5.31c.1.7.4 1.24.89 1.61.49.38 1.1.56 1.85.56.86 0 1.58-.2 2.15-.6zm6.61-1.78h-1.21c-.6 0-1.05.12-1.35.36-.3.23-.46.53-.46.89 0 .37.12.66.36.88.23.2.57.32 1.02.32.5 0 .9-.15 1.2-.43.3-.28.44-.65.44-1.1v-.92zm-4.07-2.55V9.33a4.96 4.96 0 0 1 2.5-.55c2.1 0 3.17 1.03 3.17 3.08V17H22.1v-.96c-.42.68-1.15 1.02-2.19 1.02-.76 0-1.38-.22-1.84-.66-.46-.44-.7-1-.7-1.68 0-.78.3-1.38.88-1.81.59-.43 1.4-.65 2.46-.65h1.34v-.46c0-.55-.13-.97-.4-1.25-.26-.29-.7-.43-1.32-.43-.86 0-1.65.24-2.35.72zm9.34-1.93v1.42c.39-1 1.1-1.5 2.12-1.5.15 0 .31.02.5.05v1.53c-.23-.1-.48-.14-.76-.14-.54 0-.99.24-1.34.71a2.8 2.8 0 0 0-.52 1.71V17h-1.57V8.91h1.57zm5 4.09a3 3 0 0 0 .76 2.01c.47.53 1.14.8 2 .8.64 0 1.24-.18 1.8-.53v1.4c-.53.32-1.2.48-2 .48a3.98 3.98 0 0 1-4.17-4.18c0-1.16.38-2.15 1.14-2.98a4 4 0 0 1 3.1-1.23c.7 0 1.34.15 1.92.44v1.44a3.24 3.24 0 0 0-1.77-.5A2.65 2.65 0 0 0 32.33 13zm7.92-7.28v4.58c.46-1 1.3-1.5 2.5-1.5.8 0 1.42.24 1.9.73.48.5.72 1.17.72 2.05V17H43.8v-5.1c0-.56-.14-.99-.43-1.29-.28-.3-.65-.45-1.1-.45-.54 0-1 .2-1.42.6-.4.4-.61 1.02-.61 1.85V17h-1.56V5.72h1.56zM55.2 15.74c.6 0 1.1-.25 1.5-.76.4-.5.6-1.16.6-1.95 0-.92-.2-1.62-.6-2.12-.4-.5-.92-.74-1.55-.74-.56 0-1.05.22-1.5.67-.44.45-.66 1.13-.66 2.06 0 .96.22 1.67.64 2.14.43.47.95.7 1.57.7zM53 5.72v4.42a2.74 2.74 0 0 1 2.43-1.34c1.03 0 1.86.38 2.51 1.15.65.76.97 1.78.97 3.05 0 1.13-.3 2.1-.92 2.9-.62.81-1.47 1.21-2.54 1.21s-1.9-.45-2.46-1.34V17h-1.58V5.72H53zm9.9 11.1l-3.22-7.9h1.74l1 2.62 1.26 3.42c.1-.32.48-1.46 1.15-3.42l.91-2.63h1.66l-2.92 7.87c-.78 2.07-1.96 3.1-3.56 3.1-.28 0-.53-.02-.73-.07v-1.34c.17.04.35.06.54.06 1.03 0 1.76-.57 2.17-1.7z"
                ></path>
                <path
                  fill="#5468FF"
                  d="M78.99.94h16.6a2.97 2.97 0 0 1 2.96 2.96v16.6a2.97 2.97 0 0 1-2.97 2.96h-16.6a2.97 2.97 0 0 1-2.96-2.96V3.9A2.96 2.96 0 0 1 79 .94"
                ></path>
                <path
                  fill="#FFF"
                  d="M89.63 5.97v-.78a.98.98 0 0 0-.98-.97h-2.28a.98.98 0 0 0-.97.97V6c0 .09.08.15.17.13a7.13 7.13 0 0 1 3.9-.02c.08.02.16-.04.16-.13m-6.25 1L83 6.6a.98.98 0 0 0-1.38 0l-.46.46a.97.97 0 0 0 0 1.38l.38.39c.06.06.15.04.2-.02a7.49 7.49 0 0 1 1.63-1.62c.07-.04.08-.14.02-.2m4.16 2.45v3.34c0 .1.1.17.2.12l2.97-1.54c.06-.03.08-.12.05-.18a3.7 3.7 0 0 0-3.08-1.87c-.07 0-.14.06-.14.13m0 8.05a4.49 4.49 0 1 1 0-8.98 4.49 4.49 0 0 1 0 8.98m0-10.85a6.37 6.37 0 1 0 0 12.74 6.37 6.37 0 0 0 0-12.74"
                ></path>
                <path
                  fill="#5468FF"
                  d="M120.92 18.8c-4.38.02-4.38-3.54-4.38-4.1V1.36l2.67-.42v13.25c0 .32 0 2.36 1.71 2.37v2.24zm-10.84-2.18c.82 0 1.43-.04 1.85-.12v-2.72a5.48 5.48 0 0 0-1.57-.2c-.3 0-.6.02-.9.07-.3.04-.57.12-.81.24-.24.11-.44.28-.58.49a.93.93 0 0 0-.22.65c0 .63.22 1 .61 1.23.4.24.94.36 1.62.36zm-.23-9.7c.88 0 1.62.11 2.23.33.6.22 1.09.53 1.44.92.36.4.61.92.76 1.48.16.56.23 1.17.23 1.85v6.87c-.4.1-1.03.2-1.86.32-.84.12-1.78.18-2.82.18-.69 0-1.32-.07-1.9-.2a4 4 0 0 1-1.46-.63c-.4-.3-.72-.67-.96-1.13a4.3 4.3 0 0 1-.34-1.8c0-.66.13-1.08.39-1.53.26-.45.6-.82 1.04-1.1.45-.3.95-.5 1.54-.62a8.8 8.8 0 0 1 3.79.05v-.44c0-.3-.04-.6-.11-.87a1.78 1.78 0 0 0-1.1-1.22c-.31-.12-.7-.2-1.15-.2a9.75 9.75 0 0 0-2.95.46l-.33-2.19c.34-.12.84-.23 1.48-.35.65-.12 1.34-.18 2.08-.18zm52.84 9.63c.82 0 1.43-.05 1.85-.13V13.7a5.42 5.42 0 0 0-1.57-.2c-.3 0-.6.02-.9.07-.3.04-.57.12-.81.24-.24.12-.44.28-.58.5a.93.93 0 0 0-.22.65c0 .63.22.99.61 1.23.4.24.94.36 1.62.36zm-.23-9.7c.88 0 1.63.11 2.23.33.6.22 1.1.53 1.45.92.35.39.6.92.76 1.48.15.56.23 1.18.23 1.85v6.88c-.41.08-1.03.19-1.87.31-.83.12-1.77.18-2.81.18-.7 0-1.33-.06-1.9-.2a4 4 0 0 1-1.47-.63c-.4-.3-.72-.67-.95-1.13a4.3 4.3 0 0 1-.34-1.8c0-.66.13-1.08.38-1.53.26-.45.61-.82 1.05-1.1.44-.3.95-.5 1.53-.62a8.8 8.8 0 0 1 3.8.05v-.43c0-.31-.04-.6-.12-.88-.07-.28-.2-.52-.38-.73a1.78 1.78 0 0 0-.73-.5c-.3-.1-.68-.2-1.14-.2a9.85 9.85 0 0 0-2.95.47l-.32-2.19a11.63 11.63 0 0 1 3.55-.53zm-8.03-1.27a1.62 1.62 0 0 0 0-3.24 1.62 1.62 0 1 0 0 3.24zm1.35 13.22h-2.7V7.27l2.7-.42V18.8zm-4.72 0c-4.38.02-4.38-3.54-4.38-4.1l-.01-13.34 2.67-.42v13.25c0 .32 0 2.36 1.72 2.37v2.24zm-8.7-5.9a4.7 4.7 0 0 0-.74-2.79 2.4 2.4 0 0 0-2.07-1 2.4 2.4 0 0 0-2.06 1 4.7 4.7 0 0 0-.74 2.8c0 1.16.25 1.94.74 2.62a2.4 2.4 0 0 0 2.07 1.02c.88 0 1.57-.34 2.07-1.02.49-.68.73-1.46.73-2.63zm2.74 0a6.46 6.46 0 0 1-1.52 4.23c-.49.53-1.07.94-1.76 1.22-.68.29-1.73.45-2.26.45-.53 0-1.58-.15-2.25-.45a5.1 5.1 0 0 1-2.88-3.13 7.3 7.3 0 0 1-.01-4.84 5.13 5.13 0 0 1 2.9-3.1 5.67 5.67 0 0 1 2.22-.42c.81 0 1.56.14 2.24.42.69.29 1.28.69 1.75 1.22.49.52.87 1.15 1.14 1.89a7 7 0 0 1 .43 2.5zm-20.14 0c0 1.11.25 2.36.74 2.88.5.52 1.13.78 1.91.78a4.07 4.07 0 0 0 2.12-.6V9.33c-.19-.04-.99-.2-1.76-.23a2.67 2.67 0 0 0-2.23 1 4.73 4.73 0 0 0-.78 2.8zm7.44 5.27c0 1.82-.46 3.16-1.4 4-.94.85-2.37 1.27-4.3 1.27-.7 0-2.17-.13-3.34-.4l.43-2.11c.98.2 2.27.26 2.95.26 1.08 0 1.84-.22 2.3-.66.46-.43.68-1.08.68-1.94v-.44a5.2 5.2 0 0 1-2.54.6 5.6 5.6 0 0 1-2.01-.36 4.2 4.2 0 0 1-2.58-2.71 9.88 9.88 0 0 1 .02-5.35 4.92 4.92 0 0 1 2.93-2.96 6.6 6.6 0 0 1 2.43-.46 19.64 19.64 0 0 1 4.43.66v10.6z"
                ></path>
              </svg>
            </a>
            <div
              class="post-list"
              id="search-hits"
              style="margin-left: 20px"
            ></div>
            <hr />
          </div>
          <article class="post blog">
            <h2>Jekyll and Algolia search integration<em></em></h2>
            <div
              style="margin-bottom: 20px; float: right"
              id="google_translate_element"
            ></div>

            <p class="publishdate">Sunday, 16 August 2020.</p>

            <p><img src="https://beatletech.com/images/jekyll-and-algolia.png" alt="Algolia" width="98%" title="Jekyll and Algolia" style="margin-left:0px" /></p>

<p>Recently I decided to add search functionality to my <a href="https://beatletech.com">BeatleTech</a> site (indeed, the one you are visiting right now). Not because I needed my readers to filter through the overwhelming number of articles I have written here (which I have not), but simply because I thought it would be a cool feature that would bring some nice interactivity to the site and to spark my ambition to write more blog posts going forward.</p>

<p>In this article I will explain <strong>why</strong> I picked <a href="https://www.algolia.com/">Algolia Search</a> and <strong>how</strong> it was integrated with this <a href="https://jekyllrb.com/">Jekyll</a> generated static site, including some interesting improvements.</p>

<h3 id="why-algolia-search">Why Algolia Search?</h3>

<p>While tinkering a bit with the design and layout of this site during a rainy day at a Dutch campsite, I was looking for an easy Jekyll plugin to bring search to my website. Although I have a lot of experience in working directly with <a href="https://www.elastic.co/">Elasticsearch</a>, I didn’t want to go down a route of building and deploying everything from scratch. While certainly a nice exercise, this would definitely take too much time and maintenance down the line, which wouldn’t be worth it (yet) looking at the traffic statistics. So, like I said, looking for something easy and quick to get up and running within a day.</p>

<p>After some Google search queries, I quickly stumbled upon some people recommending Algolia at the <a href="https://talk.jekyllrb.com/t/how-to-add-a-search-bar/606/7">Jekyll talk</a> discussion board.</p>

<p>Digging into Algolia, I found the following compelling reasons to integrate with Algolia Search:</p>
<ul>
  <li><strong>Known brand</strong>. It turns out I was already quite familiar (and satisfied) with Algolia Search as a consumer of <a href="https://hn.algolia.com/">Hacker News Search</a> which is powered by Algolia.</li>
  <li><strong>Free tier</strong>. They recently (July 1st) introduced more <a href="https://blog.algolia.com/introducing-algolias-most-customer-friendly-pricing/">customer-friendly pricing</a> with a starting free tier as long as you would show the “Search by Algolia” next to your search results. Also with reasonable pricing when I need to scale up.</li>
  <li><strong>Great documentation</strong>. Their <a href="https://community.algolia.com/jekyll-algolia/getting-started.html">Getting started</a> is clear, complete and up-to-date.</li>
  <li><strong>Open source</strong>. <a href="https://github.com/algolia/jekyll-algolia">Jekykll Algolia Plugin</a> for indexing Jekyll posts</li>
  <li><strong>UI Template</strong>. Template with UI component using <a href="https://community.algolia.com/instantsearch.js/">instantsearch.js</a></li>
  <li><strong>Example project</strong>. Github project <a href="https://github.com/algolia/jekyll-algolia-example">jekyll-algolia-example</a></li>
</ul>

<h3 id="how-to-integrate-algolia-and-jekyll">How to integrate Algolia and Jekyll?</h3>

<p>To integrate with Jeyll we first need to install and run the <a href="https://github.com/algolia/jekyll-algolia">jekyll-algolia-plugin</a> to push the content of our Jekyll website to our Algolia index. Secondly we need to update our HTML with templating and <a href="https://community.algolia.com/instantsearch.js/">Instantsearch.js</a>.</p>

<h4 id="1-pushing-content-to-your-algolia-index">1. Pushing content to your Algolia index</h4>

<p>This is a simple three step process, as lined out in the README of the <a href="https://github.com/algolia/jekyll-algolia">jekyll-algolia-plugin</a> repository. First add the jekyll-algolia gem to your Gemfile, after which you run <code class="language-plaintext highlighter-rouge">bundle install</code> to fetch all the dependencies:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre>  <span class="c1"># Gemfile</span>

  <span class="n">group</span> <span class="ss">:jekyll_plugins</span> <span class="k">do</span>
    <span class="n">gem</span> <span class="s1">'jekyll-algolia'</span><span class="p">,</span> <span class="s1">'~&gt; 1.0'</span>
  <span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Next, add your <code class="language-plaintext highlighter-rouge">application_id</code>, <code class="language-plaintext highlighter-rouge">index_name</code> and <code class="language-plaintext highlighter-rouge">search_only_api_key</code> to the Jekyll <code class="language-plaintext highlighter-rouge">_.config.yml</code> file:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre>  <span class="c1"># _.config.yaml</span>

  <span class="na">algolia</span><span class="pi">:</span>
    <span class="na">application_id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">your_application_id'</span>
    <span class="na">index_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">your_indexname'</span>
    <span class="na">search_only_api_key</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2b61f303d605176b556cb377d5ef3acd'</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Finally, get your private Algolia admin key (which you can find in your Algolia dashboard) and run the following to execute the indexing:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">  <span class="nv">ALGOLIA_API_KEY</span><span class="o">=</span><span class="s1">'your_admin_api_key'</span> bundle <span class="nb">exec </span>jekyll algolia</code></pre></figure>

<h4 id="2-adding-instantsearchjs-to-the-front-end">2. Adding instantsearch.js to the front-end</h4>

<p>For the front-end part I followed the excellent Algolia community <a href="https://community.algolia.com/jekyll-algolia/blog.html">tutorial</a>. Instead of repeating all the documented steps here, I’ll only highlight the relative changes I made.</p>

<p>The integration consists of two parts:</p>
<ul>
  <li>A <code class="language-plaintext highlighter-rouge">search-hits-wrapper</code> div element where we load the search results. These results are located front and center under the navigation bar (pushing the rest of the content down).</li>
  <li>The instantsearch.js dependency, template configuration and styling. All of which is located in the <code class="language-plaintext highlighter-rouge">_includes/algolia.html</code> file, which can be viewed in full in the <a href="https://github.com/beatlevic/beatletech/blob/master/_includes/algolia.html">source code</a> of this site.</li>
</ul>

<p>I made the following changes compared to the community tutorial:</p>
<ul>
  <li><strong>Hide Search results by default (style=”display:none”) and don’t fire off an empty query that returns all articles.</strong> The default empty query returns all articles and to mitigate this I added a <code class="language-plaintext highlighter-rouge">searchFunction</code> to the instantsearch options:</li>
</ul>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>  <span class="kd">const</span> <span class="nx">search</span> <span class="o">=</span> <span class="nf">instantsearch</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">K4MUG7LHCA</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2b61f303d605176b556cb377d5ef3acd</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// public read-only key</span>
    <span class="na">indexName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">prod_beatletech</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">searchFunction</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">helper</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">searchResults</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">search-hits-wrapper</span><span class="dl">"</span><span class="p">);</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">helper</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">query</span> <span class="o">===</span> <span class="dl">""</span> <span class="o">&amp;&amp;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">none</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="nx">helper</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">query</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">block</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">none</span><span class="dl">"</span><span class="p">;</span>
      <span class="nx">helper</span><span class="p">.</span><span class="nf">search</span><span class="p">();</span>
    <span class="p">},</span>
  <span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><strong>Don’t fire off a query on every keystroke.</strong> While the default of triggering a search query with every keystroke is great in terms of responsiveness, it will also help you burn quickly through your free 10k search requests. In order to trade off query responsiveness for less api requests, I added the following <code class="language-plaintext highlighter-rouge">queryHook</code> with a 500ms delay:</li>
</ul>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>  <span class="nx">search</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span>
    <span class="nx">instantsearch</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nf">searchBox</span><span class="p">({</span>
      <span class="na">container</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#search-searchbar</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">placeholder</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Search into posts...</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">poweredBy</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">autofocus</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">showLoadingIndicator</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nf">queryHook</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">refine</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">clearTimeout</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
        <span class="nx">timerId</span> <span class="o">=</span> <span class="nf">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nf">refine</span><span class="p">(</span><span class="nx">query</span><span class="p">),</span> <span class="mi">500</span><span class="p">);</span>
      <span class="p">},</span>
    <span class="p">})</span>
  <span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><strong>Show “Search by Algolia” badge.</strong> If you want to make use of the free plan, they ask you in exchange that you display a “Search by Algolia” logo next to your search results. You can use the Instantsearch searchBox options Boolean flag <code class="language-plaintext highlighter-rouge">poweredBy</code> or if you want more flexibility, as I did, you can find different versions of their logo <a href="https://www.algolia.com/press/?section=brand-guidelines">here</a> and add it to the <code class="language-plaintext highlighter-rouge">search-hits-wrapper</code> div.</li>
  <li><strong>Turn off autofocus</strong>. Add and set the searchBox option <code class="language-plaintext highlighter-rouge">autofocus</code> to <code class="language-plaintext highlighter-rouge">false</code> if you don’t want the input search to autofocus. While I at first liked the autofocus, because the user can immediately type their search query, it turns out on mobile devices you automatically zoom in on the search input field. So I recommend turning it off.</li>
</ul>

<h3 id="experience-so-far">Experience so far</h3>

<p>I really liked the whole integration process, which was really smooth and not much work. I mean, I even went as far as to write all about it here. 🙂</p>

<p>One additional benefit of Algolia, which I haven’t listed yet, is gaining statistics on your site’s search queries with weekly email updates and an interactive dashboard. Helping you figure out what your readers and followers are looking for.</p>

<p>I am using the slightly older v2 of instantsearch.js, so at some point I will want to update to the latest version, which will decrease to javascript library size. Running <a href="https://developers.google.com/speed/pagespeed/insights/?hl=nl">PageSpeed Insights</a> is still get a very comfortable 96/100 score, so there is no immediate need, but less is more when it comes to JS dependencies.</p>

<p>If my search query volume increases above the free 10k a month, then I’m happy to pay for this service. I do have one feature request for the Algolia team for the paid service, which is adding a monthly payment limit with alerting, to make sure you won’t get any surprise overcharge bill.</p>

<p>Anyway, so far a big thumbs up for Algolia. 👍</p>

<p><a href="https://news.ycombinator.com/item?id=24181472">HN Discussion</a></p>


            <br />
            <div
              style="display: block; vertical-align: baseline; height: 2px"
            ></div>
            <div class="clear_both tags">
              <span>
                tags: 
                <a href="../../../archive#javascript">javascript</a>,  
                <a href="../../../archive#jekyll">jekyll</a>,  
                <a href="../../../archive#algolia">algolia</a> 
              </span>
            </div>
            <div class="clear"></div>
            <!-- <div class="sharethis-inline-share-buttons"></div> -->
          </article>

          <div id="disqus_thread"></div>

          <h3>Possibly related posts</h3>

          <ul class="">
            

            <li>
              06 Apr 2023 &raquo;

              <a href="/2023/04/06/minimum-viable-kubernetes">Running your Startup on Kubernetes ($90 per month)</a>

              <em>
                <a
                  href="https://www.google.com/search?q=+site%3Abeatletech.com"
                  ></a
                >
              </em>
            </li>
            

            <li>
              24 Nov 2020 &raquo;

              <a href="/2020/11/24/goodbye-breakfast">Goodbye breakfast: 6 months of Intermittent Fasting</a>

              <em>
                <a
                  href="https://www.google.com/search?q=+site%3Abeatletech.com"
                  ></a
                >
              </em>
            </li>
            

            <li>
              26 Oct 2020 &raquo;

              <a href="/2020/10/26/docker-on-macos-without-noisy-fans">Docker on macOS without noisy fans</a>

              <em>
                <a
                  href="https://www.google.com/search?q=+site%3Abeatletech.com"
                  ></a
                >
              </em>
            </li>
            
          </ul>
        </div>
        <!-- end main -->
      </div>
      <!-- end content -->

      <footer id="footer" class="grid_12">
  <p>
    <div style="float: left">
      <img
        src="https://s3.eu-west-1.amazonaws.com/eu-west-1.beatletech.com/images/beatletech-logo-dark.png"
        alt="BeatleTech"
        style="width: 30px; margin-top: -20px"
      />
    </div>
    <div style="margin-left:40px;margin-top:-10px">
    Copyright &copy; 2010-2025 |
    <a
      href="https://beatletech.com"
      title="BeatleTech by Coen
    Stevens"
      >BeatleTech - Coen Stevens</a
    >
    - Built with <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> (<a
      href="https://github.com/beatlevic/beatletech"
      target="_blank"
      >source</a
    >) |
    KVK: <a href="https://www.kvk.nl/bestellen/#/51640589000021649332" target="_blank">51640589</a>
  </div>
  </p>
</footer>

<div class="clear"></div>
 <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<link
  rel="stylesheet"
  type="text/css"
  href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css"
/>

<script>
  const search = instantsearch({
    appId: "K4MUG7LHCA",
    apiKey: "2b61f303d605176b556cb377d5ef3acd",
    indexName: "prod_beatletech",
    searchFunction: function (helper) {
      var searchResults = document.getElementById("search-hits-wrapper");
      if (helper.state.query === "" && searchResults.style.display === "none") {
        return;
      }
      searchResults.style.display = helper.state.query ? "block" : "none";
      helper.search();
    },
  });

  const hitTemplate = function (hit) {
    let date = "";
    if (hit.date) {
      date = moment.unix(hit.date).format("MMM D, YYYY");
    }

    let url = `${hit.url}#${hit.anchor}`;

    const title = hit._highlightResult.title.value;

    let breadcrumbs = "";
    if (hit._highlightResult.headings) {
      breadcrumbs = hit._highlightResult.headings
        .map((match) => {
          return `<span class="post-breadcrumb">${match.value}</span>`;
        })
        .join(" > ");
    }

    const content = hit._highlightResult.html.value;

    return `
    <div class="post-item">
      <h2><a class="post-link" href="${url}">${title}</a></h2>
      <div class="publishdate" style="margin-left:0px; margin-bottom:10px">${date}</div>
      <!-- {#breadcrumbs}}<a href="${url}" class="post-breadcrumbs">${breadcrumbs}</a> -->
      <div class="post-snippet" style="margin-left: 20px">${content}</div>
    </div>
  `;
  };

  let timerId;

  search.addWidget(
    instantsearch.widgets.searchBox({
      container: "#search-searchbar",
      placeholder: "Search into posts...",
      poweredBy: false,
      autofocus: false,
      showLoadingIndicator: true,
      queryHook(query, refine) {
        clearTimeout(timerId);
        timerId = setTimeout(() => refine(query), 500);
      },
    })
  );

  search.addWidget(
    instantsearch.widgets.hits({
      container: "#search-hits",
      templates: {
        item: hitTemplate,
      },
    })
  );

  search.start();
</script>

<style>
  .ais-search-box {
    max-width: 100%;
    margin-bottom: 15px;
  }
  .post-item {
    margin-bottom: 30px;
  }
  .post-link .ais-Highlight {
    color: #111;
    font-style: normal;
    text-decoration: underline;
  }
  .post-breadcrumbs {
    color: #424242;
    display: block;
  }
  .post-breadcrumb {
    font-size: 18px;
    color: #424242;
  }
  .post-breadcrumb .ais-Highlight {
    font-weight: bold;
    font-style: normal;
    text-decoration: underline;
  }
  .post-snippet .ais-Highlight {
    color: #2a7ae2;
    font-style: normal;
    font-weight: bold;
    text-decoration: underline;
  }
  .post-snippet img {
    display: none;
  }
</style>


      <div class="clear"></div>

      <!-- <script type="text/javascript" src="../../../../js/sweet-justice.min.js"></script> -->
      <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "beatletech"; // required: replace example with your forum shortname
        //var disqus_developer = 1;

        // The following are highly recommended additional parameters. Remove the slashes in front to use.
        // var disqus_identifier = 'unique_dynamic_id_1234';
        // var disqus_url = 'http://example.com/permalink-to-page.html';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
          var dsq = document.createElement("script");
          dsq.type = "text/javascript";
          dsq.async = true;
          dsq.src = "https://" + disqus_shortname + ".disqus.com/embed.js";
          (
            document.getElementsByTagName("head")[0] ||
            document.getElementsByTagName("body")[0]
          ).appendChild(dsq);
        })();
      </script>
    </div>
    <!-- end wrapper -->

    <!-- <script src="//platform-api.sharethis.com/js/sharethis.js#property=5b6357f2f3742d0012c8870b&product=inline-share-buttons"></script> -->

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-20231246-1"]);
      _gaq.push(["_trackPageview"]);

      (function () {
        var ga = document.createElement("script");
        ga.type = "text/javascript";
        ga.async = true;
        ga.src =
          ("https:" == document.location.protocol
            ? "https://ssl"
            : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script type="text/javascript">
      function onHover() {
        var el = document.getElementById("headshot");
        el.src =
          "https://s3-eu-west-1.amazonaws.com/eu-west-1.beatletech.com/images/jc-small.png";
      }

      function offHover() {
        var el = document.getElementById("headshot");
        el.src =
          "https://s3-eu-west-1.amazonaws.com/eu-west-1.beatletech.com/images/headshot.png";
      }
    </script>

    <script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement(
          {
            pageLanguage: "en",
            includedLanguages: "en,nl,de,es,fr,ru,tr,zh-CN",
            defaultLanguage: "en",
            multilanguagePage: true,
          },
          "google_translate_element"
        );
      }
    </script>

    <script
      type="text/javascript"
      src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>
  </body>
</html>
